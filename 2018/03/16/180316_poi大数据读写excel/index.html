<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="数据处理,">










<meta name="description" content="一、描述前端时间写了注解方式Excel的读取和写入，它是根据注解完成Excel的操作，虽说支持大数据，但对于超大数据就无能为力了，因为它的读写期间都是将所有数据放入系统内存的，除非你有超大的内存。 因项目需要对超大数据的Excel读写操作，于是网上找了个超大数据的读写代码，这个不需要太大内存。并对此进行了简单的修改。  原理如下：  Excel超大数据读取：抽象Excel2007读取器，excel">
<meta name="keywords" content="数据处理">
<meta property="og:type" content="article">
<meta property="og:title" content="poi大数据读写excel">
<meta property="og:url" content="http://JackArch.github.io/2018/03/16/180316_poi大数据读写excel/index.html">
<meta property="og:site_name" content="Deep  |  Mind">
<meta property="og:description" content="一、描述前端时间写了注解方式Excel的读取和写入，它是根据注解完成Excel的操作，虽说支持大数据，但对于超大数据就无能为力了，因为它的读写期间都是将所有数据放入系统内存的，除非你有超大的内存。 因项目需要对超大数据的Excel读写操作，于是网上找了个超大数据的读写代码，这个不需要太大内存。并对此进行了简单的修改。  原理如下：  Excel超大数据读取：抽象Excel2007读取器，excel">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-06-19T09:07:00.127Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="poi大数据读写excel">
<meta name="twitter:description" content="一、描述前端时间写了注解方式Excel的读取和写入，它是根据注解完成Excel的操作，虽说支持大数据，但对于超大数据就无能为力了，因为它的读写期间都是将所有数据放入系统内存的，除非你有超大的内存。 因项目需要对超大数据的Excel读写操作，于是网上找了个超大数据的读写代码，这个不需要太大内存。并对此进行了简单的修改。  原理如下：  Excel超大数据读取：抽象Excel2007读取器，excel">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://JackArch.github.io/2018/03/16/180316_poi大数据读写excel/">





  <title>poi大数据读写excel | Deep  |  Mind</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Deep  |  Mind</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://JackArch.github.io/2018/03/16/180316_poi大数据读写excel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuangzhouzhishui">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Deep  |  Mind">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">poi大数据读写excel</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-16T15:19:46+08:00">
                2018-03-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="一、描述"><a href="#一、描述" class="headerlink" title="一、描述"></a>一、描述</h4><p>前端时间写了注解方式Excel的读取和写入，它是根据注解完成Excel的操作，虽说支持大数据，但对于超大数据就无能为力了，因为它的读写期间都是将所有数据放入系统内存的，除非你有超大的内存。</p>
<p>因项目需要对超大数据的Excel读写操作，于是网上找了个超大数据的读写代码，这个不需要太大内存。并对此进行了简单的修改。</p>
<ul>
<li><strong>原理如下：</strong></li>
</ul>
<p>Excel超大数据读取：抽象Excel2007读取器，excel2007的底层数据结构是xml文件，采用SAX的事件驱动的方法解析 xml，需要继承DefaultHandler，在遇到文件内容时，事件会触发，这种做法可以大大降低内存的耗费，特别使用于大数据量的文件。</p>
<p>Excel超大数据写入：抽象excel2007读入器，先构建.xlsx一张模板，改写模板中的sheet.xml, 使用这种方法 写入.xlsx文件，不需要太大的内存。</p>
<p>先看调用示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`String file = ``&quot;E:/导入测试数据.xlsx&quot;``;``ExcelReader reader = ``new` `ExcelReader() &#123;``public` `void` `getRows(``int` `sheetIndex, ``int` `curRow, List&lt;String&gt; rowList) &#123;``System.out.println(``&quot;Sheet:&quot;` `+ sheetIndex + ``&quot;, Row:&quot;` `+ curRow + ``&quot;, Data:&quot;` `+rowList);``&#125;``&#125;;``reader.process(file, ``1``);``String file = ``&quot;E:/导出测试数据.xlsx&quot;``;``ExcelWriter writer = ``new` `ExcelWriter() &#123;``public` `void` `generate() ``throws` `Exception &#123;``// 电子表格开始``this``.beginSheet();``for` `(``int` `rownum = ``0``; rownum &lt; ``100``; rownum++) &#123;``// 插入新行``this``.insertRow(rownum);``// 建立新单元格,索引值从0开始,表示第一列``this``.createCell(``0``, ``&quot;第 &quot;` `+ rownum + ``&quot; 行&quot;``);``this``.createCell(``1``, ``34343.123456789``);``this``.createCell(``2``, ``&quot;23.67%&quot;``);``this``.createCell(``3``, ``&quot;12:12:23&quot;``);``this``.createCell(``4``, ``&quot;2014-10-11 12:12:23&quot;``);``this``.createCell(``5``, ``&quot;true&quot;``);``this``.createCell(``6``, ``&quot;false&quot;``);``// 结束行``this``.endRow();``&#125;``// 电子表格结束``this``.endSheet();``&#125;``&#125;;``writer.process(file);``&#125;`</span><br></pre></td></tr></table></figure>

<p>这里只展示了对数据的读取和写入，如果正式保存到数据库时建议读取一部分（如100条）再写入一次数据库，尽量不要读取一条就写入一条，这样会非常耗费资源。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`import` `java.io.InputStream;``import` `java.math.BigDecimal;``import` `java.text.SimpleDateFormat;``import` `java.util.ArrayList;``import` `java.util.Date;``import` `java.util.Iterator;``import` `java.util.List;``import` `org.apache.poi.hssf.usermodel.HSSFDateUtil;``import` `org.apache.poi.openxml4j.opc.OPCPackage;``import` `org.apache.poi.xssf.eventusermodel.XSSFReader;``import` `org.apache.poi.xssf.model.SharedStringsTable;``import` `org.apache.poi.xssf.usermodel.XSSFRichTextString;``import` `org.xml.sax.Attributes;``import` `org.xml.sax.InputSource;``import` `org.xml.sax.SAXException;``import` `org.xml.sax.XMLReader;``import` `org.xml.sax.helpers.DefaultHandler;``import` `org.xml.sax.helpers.XMLReaderFactory;``/**``* Excel超大数据读取，抽象Excel2007读取器，excel2007的底层数据结构是xml文件，采用SAX的事件驱动的方法解析``* xml，需要继承DefaultHandler，在遇到文件内容时，事件会触发，这种做法可以大大降低 内存的耗费，特别使用于大数据量的文件。``* @version 2014-9-2``*/``public` `abstract` `class` `ExcelReader ``extends` `DefaultHandler &#123;``// 共享字符串表``private` `SharedStringsTable sst;``// 上一次的内容``private` `String lastContents;``private` `boolean` `nextIsString;``private` `int` `sheetIndex = -``1``;``private` `List&lt;String&gt; rowList = ``new` `ArrayList&lt;String&gt;();``// 当前行``private` `int` `curRow = ``0``;``// 当前列``private` `int` `curCol = ``0``;``// 日期标志``private` `boolean` `dateFlag;``// 数字标志``private` `boolean` `numberFlag;``private` `boolean` `isTElement;``/**``* 遍历工作簿中所有的电子表格``* @param filename``* @throws Exception``*/``public` `void` `process(String filename) ``throws` `Exception &#123;``OPCPackage pkg = OPCPackage.open(filename);``XSSFReader r = ``new` `XSSFReader(pkg);``SharedStringsTable sst = r.getSharedStringsTable();``XMLReader parser = fetchSheetParser(sst);``Iterator&lt;InputStream&gt; sheets = r.getSheetsData();``while` `(sheets.hasNext()) &#123;``curRow = ``0``;``sheetIndex++;``InputStream sheet = sheets.next();``InputSource sheetSource = ``new` `InputSource(sheet);``parser.parse(sheetSource);``sheet.close();``&#125;``&#125;``/**``* 只遍历一个电子表格，其中sheetId为要遍历的sheet索引，从1开始，1-3``* @param filename``* @param sheetId``* @throws Exception``*/``public` `void` `process(String filename, ``int` `sheetId) ``throws` `Exception &#123;``OPCPackage pkg = OPCPackage.open(filename);``XSSFReader r = ``new` `XSSFReader(pkg);``SharedStringsTable sst = r.getSharedStringsTable();``XMLReader parser = fetchSheetParser(sst);``// 根据 rId# 或 rSheet# 查找sheet``InputStream sheet2 = r.getSheet(``&quot;rId&quot;` `+ sheetId);``sheetIndex++;``InputSource sheetSource = ``new` `InputSource(sheet2);``parser.parse(sheetSource);``sheet2.close();``&#125;``public` `XMLReader fetchSheetParser(SharedStringsTable sst)``throws` `SAXException &#123;``XMLReader parser = XMLReaderFactory.createXMLReader(``&quot;org.apache.xerces.parsers.SAXParser&quot;``);``this``.sst = sst;``parser.setContentHandler(``this``);``return` `parser;``&#125;``public` `void` `startElement(String uri, String localName, String name,``Attributes attributes) ``throws` `SAXException &#123;``// System.out.println(&quot;startElement: &quot; + localName + &quot;, &quot; + name + &quot;, &quot; + attributes);``// c =&gt; 单元格``if` `(``&quot;c&quot;``.equals(name)) &#123;``// 如果下一个元素是 SST 的索引，则将nextIsString标记为true``String cellType = attributes.getValue(``&quot;t&quot;``);``if` `(``&quot;s&quot;``.equals(cellType)) &#123;``nextIsString = ``true``;``&#125; ``else` `&#123;``nextIsString = ``false``;``&#125;``// 日期格式``String cellDateType = attributes.getValue(``&quot;s&quot;``);``if` `(``&quot;1&quot;``.equals(cellDateType)) &#123;``dateFlag = ``true``;``&#125; ``else` `&#123;``dateFlag = ``false``;``&#125;``String cellNumberType = attributes.getValue(``&quot;s&quot;``);``if` `(``&quot;2&quot;``.equals(cellNumberType)) &#123;``numberFlag = ``true``;``&#125; ``else` `&#123;``numberFlag = ``false``;``&#125;``&#125;``// 当元素为t时``if` `(``&quot;t&quot;``.equals(name)) &#123;``isTElement = ``true``;``&#125; ``else` `&#123;``isTElement = ``false``;``&#125;``// 置空``lastContents = ``&quot;&quot;``;``&#125;``public` `void` `endElement(String uri, String localName, String name)``throws` `SAXException &#123;``// System.out.println(&quot;endElement: &quot; + localName + &quot;, &quot; + name);``// 根据SST的索引值的到单元格的真正要存储的字符串``// 这时characters()方法可能会被调用多次``if` `(nextIsString) &#123;``try` `&#123;``int` `idx = Integer.parseInt(lastContents);``lastContents = ``new` `XSSFRichTextString(sst.getEntryAt(idx))``.toString();``&#125; ``catch` `(Exception e) &#123;``&#125;``&#125;``// t元素也包含字符串``if` `(isTElement) &#123;``String value = lastContents.trim();``rowList.add(curCol, value);``curCol++;``isTElement = ``false``;``// v =&gt; 单元格的值，如果单元格是字符串则v标签的值为该字符串在SST中的索引``// 将单元格内容加入rowlist中，在这之前先去掉字符串前后的空白符``&#125; ``else` `if` `(``&quot;v&quot;``.equals(name)) &#123;``String value = lastContents.trim();``value = value.equals(``&quot;&quot;``) ? ``&quot; &quot;` `: value;``try` `&#123;``// 日期格式处理``if` `(dateFlag) &#123;``Date date = HSSFDateUtil.getJavaDate(Double.valueOf(value));``SimpleDateFormat dateFormat = ``new` `SimpleDateFormat(``&quot;dd/MM/yyyy&quot;``);``value = dateFormat.format(date);``&#125;``// 数字类型处理``if` `(numberFlag) &#123;``BigDecimal bd = ``new` `BigDecimal(value);``value = bd.setScale(``3``, BigDecimal.ROUND_UP).toString();``&#125;``&#125; ``catch` `(Exception e) &#123;``// 转换失败仍用读出来的值``&#125;``rowList.add(curCol, value);``curCol++;``&#125; ``else` `&#123;``// 如果标签名称为 row ，这说明已到行尾，调用 optRows() 方法``if` `(name.equals(``&quot;row&quot;``)) &#123;``getRows(sheetIndex + ``1``, curRow, rowList);``rowList.clear();``curRow++;``curCol = ``0``;``&#125;``&#125;``&#125;``public` `void` `characters(``char``[] ch, ``int` `start, ``int` `length)``throws` `SAXException &#123;``// 得到单元格内容的值``lastContents += ``new` `String(ch, start, length);``&#125;``/**``* 获取行数据回调``* @param sheetIndex``* @param curRow``* @param rowList``*/``public` `abstract` `void` `getRows(``int` `sheetIndex, ``int` `curRow, List&lt;String&gt; rowList);``/**``* 测试方法``*/``public` `static` `void` `main(String[] args) ``throws` `Exception &#123;``String file = ``&quot;E:/导入测试数据.xlsx&quot;``;``ExcelReader reader = ``new` `ExcelReader() &#123;``public` `void` `getRows(``int` `sheetIndex, ``int` `curRow, List&lt;String&gt; rowList) &#123;``System.out.println(``&quot;Sheet:&quot;` `+ sheetIndex + ``&quot;, Row:&quot;` `+ curRow + ``&quot;, Data:&quot;` `+rowList);``&#125;``&#125;;``reader.process(file, ``1``);``&#125;``&#125;`</span><br></pre></td></tr></table></figure>

<p>以下为写入程序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`import` `java.io.File;``import` `java.io.FileInputStream;``import` `java.io.FileOutputStream;``import` `java.io.FileWriter;``import` `java.io.IOException;``import` `java.io.InputStream;``import` `java.io.OutputStream;``import` `java.io.Writer;``import` `java.util.Calendar;``import` `java.util.Enumeration;``import` `java.util.zip.ZipEntry;``import` `java.util.zip.ZipFile;``import` `java.util.zip.ZipOutputStream;``import` `org.apache.poi.hssf.util.CellReference;``import` `org.apache.poi.ss.usermodel.DateUtil;``import` `org.apache.poi.xssf.usermodel.XSSFSheet;``import` `org.apache.poi.xssf.usermodel.XSSFWorkbook;``/**``* Excel超大数据写入，抽象excel2007读入器，先构建.xlsx一张模板，改写模板中的sheet.xml,``* 使用这种方法 写入.xlsx文件，不需要太大的内存``* @version 2014-9-2``*/``public` `abstract` `class` `ExcelWriter &#123;``private` `SpreadsheetWriter sw;``/**``* 写入电子表格的主要流程``*``* @param fileName``* @throws Exception``*/``public` `void` `process(String fileName) ``throws` `Exception &#123;``// 建立工作簿和电子表格对象``XSSFWorkbook wb = ``new` `XSSFWorkbook();``XSSFSheet sheet = wb.createSheet(``&quot;sheet1&quot;``);``// 持有电子表格数据的xml文件名 例如 /xl/worksheets/sheet1.xml``String sheetRef = sheet.getPackagePart().getPartName().getName();``// 保存模板``FileOutputStream os = ``new` `FileOutputStream(``&quot;template.xlsx&quot;``);``wb.write(os);``os.close();``// 生成xml文件``File tmp = File.createTempFile(``&quot;sheet&quot;``, ``&quot;.xml&quot;``);``Writer fw = ``new` `FileWriter(tmp);``sw = ``new` `SpreadsheetWriter(fw);``generate();``fw.close();``// 使用产生的数据替换模板``File templateFile = ``new` `File(``&quot;template.xlsx&quot;``);``FileOutputStream out = ``new` `FileOutputStream(fileName);``substitute(templateFile, tmp, sheetRef.substring(``1``), out);``out.close();``// 删除文件之前调用一下垃圾回收器，否则无法删除模板文件``System.gc();``// 删除临时模板文件``if` `(templateFile.isFile() &amp;&amp; templateFile.exists()) &#123;``templateFile.delete();``&#125;``&#125;``/**``* 类使用者应该使用此方法进行写操作``*``* @throws Exception``*/``public` `abstract` `void` `generate() ``throws` `Exception;``public` `void` `beginSheet() ``throws` `IOException &#123;``sw.beginSheet();``&#125;``public` `void` `insertRow(``int` `rowNum) ``throws` `IOException &#123;``sw.insertRow(rowNum);``&#125;``public` `void` `createCell(``int` `columnIndex, String value) ``throws` `IOException &#123;``sw.createCell(columnIndex, value, -``1``);``&#125;``public` `void` `createCell(``int` `columnIndex, ``double` `value) ``throws` `IOException &#123;``sw.createCell(columnIndex, value, -``1``);``&#125;``public` `void` `endRow() ``throws` `IOException &#123;``sw.endRow();``&#125;``public` `void` `endSheet() ``throws` `IOException &#123;``sw.endSheet();``&#125;``/**``*``* @param zipfile``* the template file``* @param tmpfile``* the XML file with the sheet data``* @param entry``* the name of the sheet entry to substitute, e.g.``* xl/worksheets/sheet1.xml``* @param out``* the stream to write the result to``*/``private` `static` `void` `substitute(File zipfile, File tmpfile, String entry,``OutputStream out) ``throws` `IOException &#123;``ZipFile zip = ``new` `ZipFile(zipfile);``ZipOutputStream zos = ``new` `ZipOutputStream(out);``@SuppressWarnings``(``&quot;unchecked&quot;``)``Enumeration&lt;ZipEntry&gt; en = (Enumeration&lt;ZipEntry&gt;) zip.entries();``while` `(en.hasMoreElements()) &#123;``ZipEntry ze = en.nextElement();``if` `(!ze.getName().equals(entry)) &#123;``zos.putNextEntry(``new` `ZipEntry(ze.getName()));``InputStream is = zip.getInputStream(ze);``copyStream(is, zos);``is.close();``&#125;``&#125;``zos.putNextEntry(``new` `ZipEntry(entry));``InputStream is = ``new` `FileInputStream(tmpfile);``copyStream(is, zos);``is.close();``zos.close();``&#125;``private` `static` `void` `copyStream(InputStream in, OutputStream out)``throws` `IOException &#123;``byte``[] chunk = ``new` `byte``[``1024``];``int` `count;``while` `((count = in.read(chunk)) &gt;= ``0``) &#123;``out.write(chunk, ``0``, count);``&#125;``&#125;``/**``* 在写入器中写入电子表格``*``*/``public` `static` `class` `SpreadsheetWriter &#123;``private` `final` `Writer _out;``private` `int` `_rownum;``private` `static` `String LINE_SEPARATOR = System``.getProperty(``&quot;line.separator&quot;``);``public` `SpreadsheetWriter(Writer out) &#123;``_out = out;``&#125;``public` `void` `beginSheet() ``throws` `IOException &#123;``_out.write(``&quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;&quot;``+ ``&quot;&lt;worksheet xmlns=\&quot;http://schemas.openxmlformats.org/spreadsheetml/2006/main\&quot;&gt;&quot;``);``_out.write(``&quot;&lt;sheetData&gt;&quot;` `+ LINE_SEPARATOR);``&#125;``public` `void` `endSheet() ``throws` `IOException &#123;``_out.write(``&quot;&lt;/sheetData&gt;&quot;``);``_out.write(``&quot;&lt;/worksheet&gt;&quot;``);``&#125;``/**``* 插入新行``*``* @param rownum``* 以0开始``*/``public` `void` `insertRow(``int` `rownum) ``throws` `IOException &#123;``_out.write(``&quot;&lt;row r=\&quot;&quot;` `+ (rownum + ``1``) + ``&quot;\&quot;&gt;&quot;` `+ LINE_SEPARATOR);``this``._rownum = rownum;``&#125;``/**``* 插入行结束标志``*/``public` `void` `endRow() ``throws` `IOException &#123;``_out.write(``&quot;&lt;/row&gt;&quot;` `+ LINE_SEPARATOR);``&#125;``/**``* 插入新列``*``* @param columnIndex``* @param value``* @param styleIndex``* @throws IOException``*/``public` `void` `createCell(``int` `columnIndex, String value, ``int` `styleIndex)``throws` `IOException &#123;``String ref = ``new` `CellReference(_rownum, columnIndex)``.formatAsString();``_out.write(``&quot;&lt;c r=\&quot;&quot;` `+ ref + ``&quot;\&quot; t=\&quot;inlineStr\&quot;&quot;``);``if` `(styleIndex != -``1``)``_out.write(``&quot; s=\&quot;&quot;` `+ styleIndex + ``&quot;\&quot;&quot;``);``_out.write(``&quot;&gt;&quot;``);``_out.write(``&quot;&lt;is&gt;&lt;t&gt;&quot;` `+ encoderXML(value) + ``&quot;&lt;/t&gt;&lt;/is&gt;&quot;``);``_out.write(``&quot;&lt;/c&gt;&quot;``);``&#125;``public` `void` `createCell(``int` `columnIndex, String value)``throws` `IOException &#123;``createCell(columnIndex, value, -``1``);``&#125;``public` `void` `createCell(``int` `columnIndex, ``double` `value, ``int` `styleIndex)``throws` `IOException &#123;``String ref = ``new` `CellReference(_rownum, columnIndex)``.formatAsString();``_out.write(``&quot;&lt;c r=\&quot;&quot;` `+ ref + ``&quot;\&quot; t=\&quot;n\&quot;&quot;``);``if` `(styleIndex != -``1``)``_out.write(``&quot; s=\&quot;&quot;` `+ styleIndex + ``&quot;\&quot;&quot;``);``_out.write(``&quot;&gt;&quot;``);``_out.write(``&quot;&lt;v&gt;&quot;` `+ value + ``&quot;&lt;/v&gt;&quot;``);``_out.write(``&quot;&lt;/c&gt;&quot;``);``&#125;``public` `void` `createCell(``int` `columnIndex, ``double` `value)``throws` `IOException &#123;``createCell(columnIndex, value, -``1``);``&#125;``public` `void` `createCell(``int` `columnIndex, Calendar value, ``int` `styleIndex)``throws` `IOException &#123;``createCell(columnIndex, DateUtil.getExcelDate(value, ``false``),``styleIndex);``&#125;``&#125;``// XML Encode``private` `static` `final` `String[] xmlCode = ``new` `String[``256``];``static` `&#123;``// Special characters``xmlCode[``&apos;\&apos;&apos;``] = ``&quot;&apos;&quot;``;``xmlCode[``&apos;\&quot;&apos;``] = &quot;\``&quot;&quot;``; ``// double quote``xmlCode[``&apos;&amp;&apos;``] = ``&quot;&amp;&quot;``; ``// ampersand``xmlCode[``&apos;&lt;&apos;``] = ``&quot;&lt;&quot;``; ``// lower than``xmlCode[``&apos;&gt;&apos;``] = ``&quot;&gt;&quot;``; ``// greater than``&#125;``/**``* &lt;p&gt;``* Encode the given text into xml.``* &lt;/p&gt;``*``* @param string``* the text to encode``* @return the encoded string``*/``public` `static` `String encoderXML(String string) &#123;``if` `(string == ``null``)``return` `&quot;&quot;``;``int` `n = string.length();``char` `character;``String xmlchar;``StringBuffer buffer = ``new` `StringBuffer();``// loop over all the characters of the String.``for` `(``int` `i = ``0``; i &lt; n; i++) &#123;``character = string.charAt(i);``// the xmlcode of these characters are added to a StringBuffer``// one by one``try` `&#123;``xmlchar = xmlCode[character];``if` `(xmlchar == ``null``) &#123;``buffer.append(character);``&#125; ``else` `&#123;``buffer.append(xmlCode[character]);``&#125;``&#125; ``catch` `(ArrayIndexOutOfBoundsException aioobe) &#123;``buffer.append(character);``&#125;``&#125;``return` `buffer.toString();``&#125;``/**``* 测试方法``*/``public` `static` `void` `main(String[] args) ``throws` `Exception &#123;``String file = ``&quot;E:/导出测试数据.xlsx&quot;``;``ExcelWriter writer = ``new` `ExcelWriter() &#123;``public` `void` `generate() ``throws` `Exception &#123;``// 电子表格开始``this``.beginSheet();``for` `(``int` `rownum = ``0``; rownum &lt; ``100``; rownum++) &#123;``// 插入新行``this``.insertRow(rownum);``// 建立新单元格,索引值从0开始,表示第一列``this``.createCell(``0``, ``&quot;第 &quot;` `+ rownum + ``&quot; 行&quot;``);``this``.createCell(``1``, ``34343.123456789``);``this``.createCell(``2``, ``&quot;23.67%&quot;``);``this``.createCell(``3``, ``&quot;12:12:23&quot;``);``this``.createCell(``4``, ``&quot;2014-10-11 12:12:23&quot;``);``this``.createCell(``5``, ``&quot;true&quot;``);``this``.createCell(``6``, ``&quot;false&quot;``);``// 结束行``this``.endRow();``&#125;``// 电子表格结束``this``.endSheet();``&#125;``&#125;;``writer.process(file);``&#125;``&#125;`</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/数据处理/" rel="tag"># 数据处理</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/02/07/180207_pandas时间序列resample/" rel="next" title="pandas时间序列resample">
                <i class="fa fa-chevron-left"></i> pandas时间序列resample
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/09/180409_卷积神经网络算法的一个实现 /" rel="prev" title="卷积神经网络算法的一个实现">
                卷积神经网络算法的一个实现 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">zhuangzhouzhishui</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">74</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#一、描述"><span class="nav-number">1.</span> <span class="nav-text">一、描述</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhuangzhouzhishui</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
